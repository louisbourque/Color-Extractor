function FileDragHover(e){e.stopPropagation(),e.preventDefault(),app.dropTarget.className="dragover"==e.type?"hover":""}function FileSelectHandler(e){FileDragHover(e),app.error.innerHTML="",app.output.innerHTML="";for(var t,r=e.target.files||e.dataTransfer.files,o=0;t=r[o];o++)"image"!=t.type.substring(0,5)?app.error.innerHTML+="Unsupported file type: "+t.name+"<br>":loadImage(t)}function loadImage(e){var t=new FileReader;t.onload=function(e){var t=getImageHTML(e.target.result);app.output.appendChild(t);var r=t.getElementsByTagName("img")[0],o=t.getElementsByClassName("image-details")[0];addEvent(r,"load",function(){o.innerHTML=getImageDetails(r),document.documentElement.scrollTop=document.body.scrollTop=offset(app.output).top})},t.readAsDataURL(e)}function getImageHTML(e){var t=document.createElement("div");return t.className="image-div",t.innerHTML='<img src="'+e+'"><div class="image-details"></div>',t}function getImageDetails(e){var t=getPalette(e),r=[];r[0]=getPalletAverage(e,0),r[1]=getPalletAverage(e,1),r[2]=getPalletAverage(e,2),r[3]=getPalletAverage(e,3);var o=colorArrayToHex(t[0]),a='<div class="color-block-container primary"><div class="color-block-inner"><p>Primary: </p><div class="color-block primary '+(getBrightness(t[0])<90?"dark":"")+'" style="background-color:'+o+';">'+o+'</div><button title="Copy to clipboard" class="copy-button" data-hex="'+o+'"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M2 13h4v1H2v-1zm5-6H2v1h5V7zm2 3V8l-3 3 3 3v-2h5v-2H9zM4.5 9H2v1h2.5V9zM2 12h2.5v-1H2v1zm9 1h1v2c-.02.28-.11.52-.3.7-.19.18-.42.28-.7.3H1c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h3c0-1.11.89-2 2-2 1.11 0 2 .89 2 2h3c.55 0 1 .45 1 1v5h-1V6H1v9h10v-2zM2 5h8c0-.55-.45-1-1-1H8c-.55 0-1-.45-1-1s-.45-1-1-1-1 .45-1 1-.45 1-1 1H3c-.55 0-1 .45-1 1z"></path></svg></button></div></div>';a+='<div class="color-background-gradient" style="background-image: linear-gradient(to right, '+colorArrayToHex(r[0])+" 0%, "+colorArrayToHex(r[1])+" 50%, "+colorArrayToHex(r[2])+" 75%, "+colorArrayToHex(r[3])+' 100%);"><button title="Copy to clipboard" class="copy-button" data-hex="background-image: linear-gradient(to right, '+colorArrayToHex(r[0])+" 0%, "+colorArrayToHex(r[1])+" 50%, "+colorArrayToHex(r[2])+" 75%, "+colorArrayToHex(r[3])+' 100%);"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M2 13h4v1H2v-1zm5-6H2v1h5V7zm2 3V8l-3 3 3 3v-2h5v-2H9zM4.5 9H2v1h2.5V9zM2 12h2.5v-1H2v1zm9 1h1v2c-.02.28-.11.52-.3.7-.19.18-.42.28-.7.3H1c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h3c0-1.11.89-2 2-2 1.11 0 2 .89 2 2h3c.55 0 1 .45 1 1v5h-1V6H1v9h10v-2zM2 5h8c0-.55-.45-1-1-1H8c-.55 0-1-.45-1-1s-.45-1-1-1-1 .45-1 1-.45 1-1 1H3c-.55 0-1 .45-1 1z"></path></svg></button><p>background-image: linear-gradient(to right, '+colorArrayToHex(r[0])+" 0%, "+colorArrayToHex(r[1])+" 50%, "+colorArrayToHex(r[2])+" 75%, "+colorArrayToHex(r[3])+" 100%);</p></div>";for(var i=1;i<t.length;i++)o=colorArrayToHex(t[i]),a+='<div class="color-block-container"><div class="color-block-inner"><div class="color-block '+(getBrightness(t[i])<90?"dark":"")+'" style="background-color:'+o+';">'+o+'</div><button title="Copy to clipboard" class="copy-button" data-hex="'+o+'"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M2 13h4v1H2v-1zm5-6H2v1h5V7zm2 3V8l-3 3 3 3v-2h5v-2H9zM4.5 9H2v1h2.5V9zM2 12h2.5v-1H2v1zm9 1h1v2c-.02.28-.11.52-.3.7-.19.18-.42.28-.7.3H1c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h3c0-1.11.89-2 2-2 1.11 0 2 .89 2 2h3c.55 0 1 .45 1 1v5h-1V6H1v9h10v-2zM2 5h8c0-.55-.45-1-1-1H8c-.55 0-1-.45-1-1s-.45-1-1-1-1 .45-1 1-.45 1-1 1H3c-.55 0-1 .45-1 1z"></path></svg></button></div></div>';return a}function colorArrayToHex(e){return e.reduce(function(e,t){return e+(t<16?"0"+t.toString(16):t.toString(16))},"#")}function getBrightness(e){return(299*e[0]+587*e[1]+114*e[2])/1e3}var app=app||{};app.fileselect=document.getElementById("file-select-input"),app.error=document.getElementById("error"),app.output=document.getElementById("output"),app.dropTarget=document.getElementById("filedrag"),window.File&&window.FileList&&window.FileReader&&(app.fileselect.addEventListener("change",FileSelectHandler,!1),document.addEventListener("dragover",FileDragHover,!1),document.addEventListener("dragleave",FileDragHover,!1),document.addEventListener("drop",FileSelectHandler,!1),document.getElementById("filedrag").style.display="block",live("button.copy-button","click",function(e){copyTextToClipboard(e.target.getAttribute("data-hex"))}));
function addEvent(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)}function removeEvent(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n)}function offset(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+o,left:t.left+n}}function live(e,t,n,o){addEvent(o||document,t,function(t){var l=(o||document).querySelectorAll(e);if(l){for(var d=t.target||t.srcElement,c=-1;d&&(c=Array.prototype.indexOf.call(l,d))===-1;)d=d.parentElement;c>-1&&n.call(d,t)}})}function copyTextToClipboard(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){}document.body.removeChild(t)}
function getPalette(r){var t=5,n=14,o=document.createElement("canvas"),e=o.getContext("2d");document.body.appendChild(o);var u=o.width=r.width,a=o.height=r.height;e.drawImage(r,0,0,u,a);for(var i,f,c,v,p,h=e.getImageData(0,0,u,a).data,l=u*a,s=[],g=0;g<l;g+=t)i=4*g,f=h[i+0],c=h[i+1],v=h[i+2],p=h[i+3],p>=125&&(f>250&&c>250&&v>250||s.push([f,c,v]));var b=MMCQ.quantize(s,n),d=b?b.palette():null;return o.parentNode.removeChild(o),d}function getPalletAverage(r,t){var n=5,o=document.createElement("canvas"),e=o.getContext("2d");document.body.appendChild(o);var u=o.width=r.width,a=o.height=r.height;e.drawImage(r,0,0,u,a);var i;i="undefined"!=typeof t?e.getImageData(Math.floor(u/4*t),0,Math.floor(u/4),a).data:e.getImageData(0,0,u,a).data;for(var f=i.length,c=-4,v=0,p={r:0,g:0,b:0};(c+=4*n)<f;)++v,p.r+=i[c],p.g+=i[c+1],p.b+=i[c+2];return p.r=Math.floor(p.r/v),p.g=Math.floor(p.g/v),p.b=Math.floor(p.b/v),o.parentNode.removeChild(o),[p.r,p.g,p.b]}if(!pv)var pv={map:function(r,t){var n={};return t?r.map(function(r,o){return n.index=o,t.call(n,r)}):r.slice()},naturalOrder:function(r,t){return r<t?-1:r>t?1:0},sum:function(r,t){var n={};return r.reduce(t?function(r,o,e){return n.index=e,r+t.call(n,o)}:function(r,t){return r+t},0)},max:function(r,t){return Math.max.apply(null,t?pv.map(r,t):r)}};var MMCQ=function(){function r(r,t,n){return(r<<2*f)+(t<<f)+n}function t(r){function t(){n.sort(r),o=!0}var n=[],o=!1;return{push:function(r){n.push(r),o=!1},peek:function(r){return o||t(),void 0===r&&(r=n.length-1),n[r]},pop:function(){return o||t(),n.pop()},size:function(){return n.length},map:function(r){return n.map(r)},debug:function(){return o||t(),n}}}function n(r,t,n,o,e,u,a){var i=this;i.r1=r,i.r2=t,i.g1=n,i.g2=o,i.b1=e,i.b2=u,i.histo=a}function o(){this.vboxes=new t(function(r,t){return pv.naturalOrder(r.vbox.count()*r.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function e(t){var n,o,e,u,a=1<<3*f,i=new Array(a);return t.forEach(function(t){o=t[0]>>c,e=t[1]>>c,u=t[2]>>c,n=r(o,e,u),i[n]=(i[n]||0)+1}),i}function u(r,t){var o,e,u,a=1e6,i=0,f=1e6,v=0,p=1e6,h=0;return r.forEach(function(r){o=r[0]>>c,e=r[1]>>c,u=r[2]>>c,o<a?a=o:o>i&&(i=o),e<f?f=e:e>v&&(v=e),u<p?p=u:u>h&&(h=u)}),new n(a,i,f,v,p,h,t)}function a(t,n){function o(r){var t,o,e,u,a,i=r+"1",c=r+"2",v=0;for(f=n[i];f<=n[c];f++)if(s[f]>l/2){for(e=n.copy(),u=n.copy(),t=f-n[i],o=n[c]-f,a=t<=o?Math.min(n[c]-1,~~(f+o/2)):Math.max(n[i],~~(f-1-t/2));!s[a];)a++;for(v=g[a];!v&&s[a-1];)v=g[--a];return e[c]=a,u[i]=e[c]+1,[e,u]}}if(n.count()){var e=n.r2-n.r1+1,u=n.g2-n.g1+1,a=n.b2-n.b1+1,i=pv.max([e,u,a]);if(1==n.count())return[n.copy()];var f,c,v,p,h,l=0,s=[],g=[];if(i==e)for(f=n.r1;f<=n.r2;f++){for(p=0,c=n.g1;c<=n.g2;c++)for(v=n.b1;v<=n.b2;v++)h=r(f,c,v),p+=t[h]||0;l+=p,s[f]=l}else if(i==u)for(f=n.g1;f<=n.g2;f++){for(p=0,c=n.r1;c<=n.r2;c++)for(v=n.b1;v<=n.b2;v++)h=r(c,f,v),p+=t[h]||0;l+=p,s[f]=l}else for(f=n.b1;f<=n.b2;f++){for(p=0,c=n.r1;c<=n.r2;c++)for(v=n.g1;v<=n.g2;v++)h=r(c,v,f),p+=t[h]||0;l+=p,s[f]=l}return s.forEach(function(r,t){g[t]=l-r}),o(i==e?"r":i==u?"g":"b")}}function i(r,n){function i(r,t){for(var n,o=1,e=0;e<v;)if(n=r.pop(),n.count()){var u=a(f,n),i=u[0],c=u[1];if(!i)return;if(r.push(i),c&&(r.push(c),o++),o>=t)return;if(e++>v)return}else r.push(n),e++}if(!r.length||n<2||n>256)return!1;var f=e(r),c=0;f.forEach(function(){c++});var h=u(r,f),l=new t(function(r,t){return pv.naturalOrder(r.count(),t.count())});l.push(h),i(l,p*n);for(var s=new t(function(r,t){return pv.naturalOrder(r.count()*r.volume(),t.count()*t.volume())});l.size();)s.push(l.pop());i(s,n-s.size());for(var g=new o;s.size();)g.push(s.pop());return g}var f=5,c=8-f,v=1e3,p=.75;return n.prototype={volume:function(r){var t=this;return t._volume&&!r||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(t){var n=this,o=n.histo;if(!n._count_set||t){var e,u,a,i=0;for(e=n.r1;e<=n.r2;e++)for(u=n.g1;u<=n.g2;u++)for(a=n.b1;a<=n.b2;a++)index=r(e,u,a),i+=o[index]||0;n._count=i,n._count_set=!0}return n._count},copy:function(){var r=this;return new n(r.r1,r.r2,r.g1,r.g2,r.b1,r.b2,r.histo)},avg:function(t){var n=this,o=n.histo;if(!n._avg||t){var e,u,a,i,c,v=0,p=1<<8-f,h=0,l=0,s=0;for(u=n.r1;u<=n.r2;u++)for(a=n.g1;a<=n.g2;a++)for(i=n.b1;i<=n.b2;i++)c=r(u,a,i),e=o[c]||0,v+=e,h+=e*(u+.5)*p,l+=e*(a+.5)*p,s+=e*(i+.5)*p;v?n._avg=[~~(h/v),~~(l/v),~~(s/v)]:n._avg=[~~(p*(n.r1+n.r2+1)/2),~~(p*(n.g1+n.g2+1)/2),~~(p*(n.b1+n.b2+1)/2)]}return n._avg},contains:function(r){var t=this,n=r[0]>>c;return gval=r[1]>>c,bval=r[2]>>c,n>=t.r1&&n<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},o.prototype={push:function(r){this.vboxes.push({vbox:r,color:r.avg()})},palette:function(){return this.vboxes.map(function(r){return r.color})},size:function(){return this.vboxes.size()},map:function(r){for(var t=this.vboxes,n=0;n<t.size();n++)if(t.peek(n).vbox.contains(r))return t.peek(n).color;return this.nearest(r)},nearest:function(r){for(var t,n,o,e=this.vboxes,u=0;u<e.size();u++)n=Math.sqrt(Math.pow(r[0]-e.peek(u).color[0],2)+Math.pow(r[1]-e.peek(u).color[1],2)+Math.pow(r[2]-e.peek(u).color[2],2)),(n<t||void 0===t)&&(t=n,o=e.peek(u).color);return o},forcebw:function(){var r=this.vboxes;r.sort(function(r,t){return pv.naturalOrder(pv.sum(r.color),pv.sum(t.color))});var t=r[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(r[0].color=[0,0,0]);var n=r.length-1,o=r[n].color;o[0]>251&&o[1]>251&&o[2]>251&&(r[n].color=[255,255,255])}},{quantize:i}}();